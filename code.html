<!doctype html>
<html lang="en" class="h-100">

<head>
    <title>LoanCodes: A Coding Project By Jason Popejoy</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">

    <script src="https://kit.fontawesome.com/5db21ba9c6.js" crossorigin="anonymous"></script>

    <link rel="icon" type="image/png" href="/img/favicon-32x32.png">

    <link href="/css/prism.css" rel="stylesheet">

    <link href="/css/site.css" rel="stylesheet">

</head>

<body class="d-flex flex-column h-100">

    <!-- Nav Section -->
    <nav class="navbar navbar-expand-md navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#"><img src="/img/JPMark.jpg" class="d-inline-block align-text-top"
                    alt="Jason Popejoy Logo" width="40" height="38"> LoanCodes</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse"
                aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarCollapse">
                <ul class="navbar-nav me-auto mb-2 mb-md-0">
                    <li class="nav-item">
                        <a class="nav-link"" href=" /index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/app.html">The App</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="/code.html">The Code</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" target="_blank" href="https://github.com/jaspopejoy/loancodes">Git Repo</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" target="_blank" href="https://jasons-old-portfolio.netlify.app/">About</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Section -->
    <main class="flex-shrink-0">
        <div class="container py-5 px-5">
            <h2 class="border-1 border-bottom border-dark mt-5">The Code for LOANCODES.</h2>
            <div class="row row-cols-1 row-cols-lg-2">
                <div class="col-lg-8">
                    <pre class="line-numbers"><code class="language-javascript">
                      
                        //get the values from the interface
                        //start or controller function
                        function getValues() {
                            //get user values from the document
                            let loanAmount = document.getElementById("loanAmt").value;
                            let numberOfPayments = document.getElementById("numPayments").value;
                            let interestRate = document.getElementById("interestRate").value;

                            //parse numbers
                            loanAmount = parseInt(loanAmount);
                            numberOfPayments = parseInt(numberOfPayments);
                            interestRate = parseInt(interestRate);

                            //check to make sure they are integers
                            if (Number.isInteger(loanAmount) && Number.isInteger(numberOfPayments) && Number.isInteger(interestRate)) {

                                //call calculateValues
                                let loanArray = calculateValues(loanAmount, numberOfPayments, interestRate);

                                //call displayResults
                                displayResults(loanArray);

                            } else {
                                alert("You must enter valid numbers");
                            }
                        }

                        //logic function(s)
                        //calculate the loan amt, loan term, and interest rate
                        function calculateValues(loanAmount, numberOfPayments, interestRate) {

                            //assign variables and set array
                            let returnArray = [];
                            let remainingBalance = loanAmount;
                            let totalInterestPaid = 0;

                            //loop through the values and push to returnArray
                            for (let i = 1; i <= numberOfPayments; i++) {
                                returnArray.push(i);

                                //calculate monthly payments
                                let monthlyPayment = (loanAmount * ((interestRate / 1200) / (1 - Math.pow(1 + (interestRate / 1200), (numberOfPayments * -1)))));
                                returnArray.push(monthlyPayment);

                                //calculate interest paid and principal paid and push into array
                                let interestPaid = remainingBalance * (interestRate / 1200);
                                let principalPaid = monthlyPayment - interestPaid
                                returnArray.push(principalPaid);
                                returnArray.push(interestPaid);

                                //calculate total interest paid and push to array
                                totalInterestPaid += interestPaid;
                                returnArray.push(totalInterestPaid);

                                //calculate balance and push to array
                                remainingBalance -= principalPaid;
                                returnArray.push(remainingBalance);
                            }

                            //print monthly payment to the display
                            document.getElementById("monthlyPayment").classList.add("output-payment");
                            document.getElementById("monthlyPayment").innerHTML = `${returnArray[1].toLocaleString('en-US', {
                                style: 'currency',
                                currency: 'USD',
                                minimumFractionDigits: 2
                            })}`;

                            //print total principal to the display
                            document.getElementById("totalPrincipal").innerHTML = `${loanAmount.toLocaleString('en-US', {
                                style: 'currency',
                                currency: 'USD',
                                minimumFractionDigits: 2
                            })}`;

                            //print total interest to the display
                            document.getElementById("totalInterest").innerHTML = `${totalInterestPaid.toLocaleString('en-US', {
                                style: 'currency',
                                currency: 'USD',
                                minimumFractionDigits: 2
                            })}`;
                            
                            //calculate total cost
                            let totalCost = totalInterestPaid + loanAmount;

                            //print total cost to the screen
                            document.getElementById("totalCost").innerHTML = `${totalCost.toLocaleString('en-US', {
                                style: 'currency',
                                currency: 'USD',
                                minimumFractionDigits: 2
                            })}`;

                            return returnArray;
                        }

                        //display amortization table
                        function displayResults(loanArray) {

                            //get the tale body element from the page
                            let tableBody = document.getElementById("results");

                            //get the template row
                            let templateRow = document.getElementById("dataTemplate");

                            //clear the table first
                            tableBody.innerHTML = "";

                            // loop through and add values to the created table
                            for (let index = 0; index < loanArray.length; index += 6) {

                                let tableRow = document.importNode(templateRow.content, true);

                                //grabs the tds to put into array
                                let rowCols = tableRow.querySelectorAll("td");

                                rowCols[0].textContent = loanArray[index];
                                rowCols[1].textContent = loanArray[index + 1].toLocaleString('en-US', {
                                    style: 'currency',
                                    currency: 'USD',
                                    minimumFractionDigits: 2
                                });

                                rowCols[2].textContent = loanArray[index + 2].toLocaleString('en-US', {
                                    style: 'currency',
                                    currency: 'USD',
                                    minimumFractionDigits: 2
                                });

                                rowCols[3].textContent = loanArray[index + 3].toLocaleString('en-US', {
                                    style: 'currency',
                                    currency: 'USD',
                                    minimumFractionDigits: 2
                                });

                                rowCols[4].textContent = loanArray[index + 4].toLocaleString('en-US', {
                                    style: 'currency',
                                    currency: 'USD',
                                    minimumFractionDigits: 2
                                });

                                rowCols[5].textContent = loanArray[index + 5].toLocaleString('en-US', {
                                    style: 'currency',
                                    currency: 'USD',
                                    minimumFractionDigits: 2
                                });

                                tableBody.appendChild(tableRow);
                            }
                        }
                    </code>
                    </pre>
                </div>
                <div class="col-lg-4">
                    <p>The Code is structured in three function.</p>
                    <h5>getValues()</h5>
                    <p>The <strong>getValues</strong> function declares variables to hold the user entered data from the
                        page's form.
                        It then validates these values by parsing them to see if they are a valid number. If they are
                        not, an alert is shown to the user. If the values are valid they are passed to the
                        <strong>calculateValues()</strong> function. The array returned from this function is then
                        passed to the <strong>displayResults()</strong> function.
                    </p>
                    <h5>calculateValues()</h5>
                    <p>The <strong>calculateValues()</strong> function declares variables and tracks the remaining
                        balance and interest paid. It loops through the number of payments entered by the user and
                        calculates the monthly payment. It also updates the interest and principal paid and stores them
                        in an array. The function then takes these values and updates the document. Finally the function
                        returns the array with the stored data to the getValues() array.</p>
                    <h5>displayResults()</h5>
                    <p>The <strong>displayResults()</strong> function recieves the array of values from the
                        <strong>calculateValues()</strong> function and enters them into a table. It retrieves the table
                        template from the document and loops through the array several times, inserting values into
                        snippets and appends them to the table body.
                    </p>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer Section-->
    <footer class="footer mt-auto py-3 sticky-footer">
        <div class="container-fluid">
            <div class="row row-cols-1 row-cols-lg-3 gy-2">
                <div class="col order-last order-lg-first text-light">
                    <div><span class="text-muted">&copy;2023</span> Jason Popejoy | jaspopejoy@gmail.com</div>
                </div>
                <div class="col d-flex align-items-center justify-content-start justify-content-lg-center">
                    <img src="/img/JPLogo White.svg" alt="Jason Popejoy Logo" height="45">
                </div>
                <div class="col d-flex align-items-center justify-content-start justify-content-lg-end">
                    <div class="row">
                        <div class="col social"><a href="https://www.linkedin.com/in/jason-popejoy/" target="_blank"><i
                                    class="fab fa-linkedin fa-2x"></i></a>
                        </div>
                        <div class="col social"><a href="https://twitter.com/jaspopejoy" target="_blank"><i
                                    class="fab fa-twitter fa-2x"></i></a>
                        </div>
                        <div class="col social"><a href="https://github.com/jaspopejoy" target="_blank"><i
                                    class="fab fa-github fa-2x"></i></a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ" crossorigin="anonymous">
        </script>
    <script src="/js/prism.js"></script>
    <script>
        Prism.plugins.Normalizewhitespace.setDefaults({
            'remove-trailing': true,
            'remove-indent': true,
            'left-trim': true,
            'right-trim': true
        })
    </script>

</body>

</html>